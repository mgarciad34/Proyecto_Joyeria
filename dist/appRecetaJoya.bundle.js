(()=>{"use strict";let e=JSON.parse(sessionStorage.getItem("joya-guardada")),t=JSON.parse(sessionStorage.getItem("id-usuario")),n=document.getElementById("botones"),a=document.getElementById("btnFabricar"),o=!0;(async function(e){try{const t=await fetch("http://127.0.0.1:8000/api/recetas/"+e);if(!t.ok)throw new Error("No se pudo obtener las joyas");return await t.json()}catch(e){return!1}})(e).then((function(e){!function(e){let t=document.getElementById("tabla_receta");for(let n=0;n<e.detalle.length;n++){console.log(e.detalle[n]);let d=document.createElement("tr"),r=document.createElement("td"),i=document.createElement("span");i.textContent=e.detalle[n].id_componente;let c=document.createElement("td"),l=document.createElement("span");l.textContent=e.detalle[n].tipo;let s=document.createElement("td"),u=document.createElement("span");u.textContent=e.detalle[n].cantidad_necesaria;let p=document.createElement("td"),m=document.createElement("span");m.textContent=e.detalle[n].cantidad_disponible,e.detalle[n].cantidad_disponible<e.detalle[n].cantidad_necesaria&&(m.style.color="red",o=!1,a.disabled=!0),r.appendChild(i),c.appendChild(l),s.appendChild(u),p.appendChild(m),d.appendChild(r),d.appendChild(c),d.appendChild(s),d.appendChild(p),t.appendChild(d)}}(e)})),async function(e,t){try{let n="http://127.0.0.1:8000/api/joyas/owner/"+e+"/"+t;const a={method:"GET",headers:{"Content-Type":"application/json"}},o=await fetch(n,a);if(!o.ok)throw new Error("No se pudo obtener el valor");return await o.json()}catch(e){return e}}(e,t).then((function(t){console.log(t),t.resultado&&function(){let t=document.createElement("td"),a=document.createElement("button");a.textContent="Eliminar",a.setAttribute("id",e),a.style.backgroundColor=" red",a.addEventListener("click",(function(t){confirm("¿Estas seguro que deseas eliminar esta joya? ")&&async function(e){try{let t="http://127.0.0.1:8000/api/joyas/eliminar/"+e;const n={method:"DELETE",headers:{"Content-Type":"aplication/json"}},a=await fetch(t,n);if(!a.ok)throw new Error("No se pudo obtener las categorias");return await a.json()}catch(e){return e}}(e).then((function(){window.location.href="./listaJoyas.html"}))}));let o=document.createElement("td"),d=document.createElement("button");d.textContent="Modificar",d.setAttribute("id",e),d.style.backgroundColor=" orange",d.addEventListener("click",(function(e){sessionStorage.setItem("joya-guardada",JSON.parse(d.id)),window.location.href="./modificarJoya.html"})),t.appendChild(a),o.appendChild(d),n.appendChild(t),n.appendChild(o)}()})),a.addEventListener("click",(function(){o?confirm("¿Estás seguro de que deseas continuar?")&&async function(e,t){let n={};n.id_usuario=t;try{let t="http://127.0.0.1:8000/api/joya/fabricar/"+e;const a={method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)},o=await fetch(t,a);if(!o.ok)throw new Error("No se pudo fabricar la joya");return await o.json()}catch(e){return e}}(e,t).then((function(e){window.location.reload()})):alert("Recursos insuficientes")}))})();